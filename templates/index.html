{% extends "layout.html" %}

{% block body %}
<h1>Search for Songs</h1>
<form action="/" method="GET">
    <input type="text" name="q" placeholder="Search for a song or artist" required>
    <button type="submit">Search</button>
</form>

{% if songs %}
    <h2>Search Results</h2>
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Artist</th>
                <th>Rate and Review</th>
            </tr>
        </thead>
        <tbody>
            {% for song in songs %}
            <tr>
                <td>{{ song.title }}</td>
                <td>{{ song.artist }}</td>
                <td>
                    <form action="/rate" method="POST">
                        <input type="hidden" name="song_id" value="{{ song.id }}">
                        <label for="rating">Rating (1-5):</label>
                        <input type="number" name="rating" min="1" max="5" required>
                        <br>
                        <textarea name="review" placeholder="Write your review..." required></textarea>
                        <br>
                        <button type="submit">Submit</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    {% if request.args.get("q") %}
        <p>No results found for "{{ request.args.get('q') }}".</p>
    {% endif %}
{% endif %}
{% endblock %}
